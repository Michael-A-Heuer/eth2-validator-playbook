#
# This playbook installs:
# - Lighthouse (Eth2)
# - Geth (Eth1)
# - Besue (Eth1)
# - Prometheus
# - Grafana
#
# It is based on Somer Esat's guide found here:
# https://medium.com/@SomerEsat/guide-to-staking-on-ethereum-2-0-ubuntu-medalla-lighthouse-c6f3c34597a8
#
---
- name: Eth2 Validator Playbook (Medalla Testnet)
  hosts: all

  # By default this playbook uses the 'ubuntu' user, but this can be
  # overwritten with the PLAYBOOK_USER environment variable. This user needs
  # sudo access on the remote system.
  user: "{{ lookup('env', 'PLAYBOOK_USER') | default('ubuntu') }}"

  tasks:
    #
    # Misc Pre-Install Stuff
    #
    - import_tasks: tasks/pre-install.yml

    #
    # Main Installation
    #
    - import_tasks: tasks/grub.yml

    - import_tasks: tasks/chrony.yml
    
    - import_tasks: tasks/unattented-upgrades.yml
    
    - import_tasks: tasks/sensors.yml
    
    - import_tasks: tasks/sata-mount.yml

    - import_tasks: tasks/usb-automount.yml
    
    - import_tasks: tasks/geth.yml

    - import_tasks: tasks/besu.yml

    - import_tasks: tasks/lighthouse.yml

    - import_tasks: tasks/metrics.yml

    - import_tasks: tasks/scripts.yml
